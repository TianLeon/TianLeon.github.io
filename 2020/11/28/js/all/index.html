<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="TianLeon">
    
    <title>
        
            手动实现常见的JS源码 |
        
        Leon&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="https://img0.baidu.com/it/u=861876668,2170248895&fm=26&fmt=auto&gp=0.jpg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":false,"init_open":false},"style":{"primary_color":"#00FA9A","avatar":"/images/nexus.JPG","favicon":"https://img0.baidu.com/it/u=861876668,2170248895&fm=26&fmt=auto&gp=0.jpg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"鸟因为想飞才会在天空飞"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":false},"code_copy":{"enable":false,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":true},"version":"3.4.3"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Leon&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">手动实现常见的JS源码</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/nexus.JPG">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">TianLeon</span>
                        
                            <span class="author-label">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2020-11-28 16:16:46
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/js/">js</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    

    
    
    
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h1 id="手动实现常见的JS源码"><a href="#手动实现常见的JS源码" class="headerlink" title="手动实现常见的JS源码"></a>手动实现常见的JS源码</h1><h2 id="ES5实现call"><a href="#ES5实现call" class="headerlink" title="ES5实现call"></a>ES5实现call</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*封装call*/</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.selfCall = <span class="function"><span class="keyword">function</span> <span class="title">selfCall</span>(<span class="params">context, ...args</span>) </span>&#123;</span><br><span class="line">  context || (context = <span class="built_in">window</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">this</span> !==<span class="string">&#x27;function&#x27;</span>) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&#x27;selfCall is called must be a function&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> fnc = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">const</span> caller = <span class="built_in">Symbol</span>(<span class="string">&#x27;caller&#x27;</span>);</span><br><span class="line">  context[caller] = fnc;</span><br><span class="line">  <span class="keyword">let</span> res = context[caller](...args);</span><br><span class="line">  <span class="keyword">delete</span> context[caller];</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 看看call怎么用</span></span><br><span class="line"><span class="comment">* 1. call是Function原型上面的一个方法</span></span><br><span class="line"><span class="comment">* 2. call 函数参数 xxx.call(上下文,参数(可以有多个参数))   //xxx是一个函数</span></span><br><span class="line"><span class="comment">* 3. 相当于执行xxx函数 只不过 传递了上下文对象 this</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span> (<span class="params">cook</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>,cook);<span class="comment">//window / node对象</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// fn1.call(&#123;obj:&#123;&#125;&#125;,&#x27;爆炒鱿鱼&#x27;);</span></span><br><span class="line">fn1.selfCall(&#123;<span class="attr">obj</span>:<span class="string">&#x27;lala&#x27;</span>&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ES5实现bind"><a href="#ES5实现bind" class="headerlink" title="ES5实现bind"></a>ES5实现bind</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 实现bind函数</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> selfBind = <span class="function"><span class="keyword">function</span> (<span class="params">bindTarget, ...args1</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/*不是函数调用抛出错误*/</span></span><br><span class="line">  <span class="comment">/*封装函数 如果没有绑定this则绑定 否则直接返回该函数*/</span></span><br><span class="line">  <span class="comment">/*绑定原型*/</span></span><br><span class="line">  <span class="comment">/*原型链绑定*/</span></span><br><span class="line">  <span class="comment">/*返回该函数*/</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*1:*/</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">this</span> !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&#x27;selfBind must be called a function&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/*2:*/</span></span><br><span class="line">  <span class="keyword">const</span> func = <span class="built_in">this</span>;</span><br><span class="line">  <span class="keyword">const</span> boundFn = <span class="function"><span class="keyword">function</span> (<span class="params">...args2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> args = [...args1, ...args2];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">new</span>.target) &#123;</span><br><span class="line">      <span class="comment">/*判断this必须是对象或者方法 */</span></span><br><span class="line">      <span class="keyword">let</span> res = func.apply(<span class="built_in">this</span>, args);</span><br><span class="line">      <span class="comment">//new之后点出方法或者属性</span></span><br><span class="line">      <span class="keyword">if</span> ((<span class="keyword">typeof</span> res === <span class="string">&#x27;function&#x27;</span> || <span class="keyword">typeof</span> res === <span class="string">&#x27;object&#x27;</span>) &amp;&amp; res !== <span class="literal">null</span>) <span class="keyword">return</span> res;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      func.apply(bindTarget, args);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> func;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="comment">/*原型赋值*/</span></span><br><span class="line">  <span class="built_in">this</span>.prototype &amp;&amp; (boundFn.prototype = <span class="built_in">Object</span>.create(<span class="built_in">this</span>.prototype));</span><br><span class="line">  <span class="comment">/*原型链赋值*/</span></span><br><span class="line">  <span class="comment">/*取出this中的所有原型链对象属性*/</span></span><br><span class="line">  <span class="keyword">let</span> des = <span class="built_in">Object</span>.getOwnPropertyDescriptors(func);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;des.length&#x27;</span>,des.length);</span><br><span class="line">  <span class="built_in">Object</span>.defineProperties(boundFn,&#123;</span><br><span class="line">    <span class="attr">length</span>: des.length,</span><br><span class="line">    <span class="attr">name</span>:<span class="built_in">Object</span>.assign(des,&#123;</span><br><span class="line">      <span class="attr">value</span>:<span class="string">`bound<span class="subst">$&#123;des.name.value&#125;</span>`</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> boundFn;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* bind函数的使用</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  <span class="function"><span class="title">getName</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">&#x27;Obj name&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">selfName</span>: <span class="string">&#x27;Obj&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> obj2 = &#123;</span><br><span class="line">  <span class="function"><span class="title">getAge</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.info(<span class="string">&#x27;Obj2 age&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">selfName</span>: <span class="string">&#x27;Obj2&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aaa</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(args);</span><br><span class="line">  <span class="comment">// console.log(this, index, aa);</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">aaa.prototype.name = <span class="string">&#x27;zhangsan&#x27;</span>;</span><br><span class="line"><span class="built_in">Object</span>.prototype.selfBind = selfBind;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> newAaa = aaa.selfBind(obj2, <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="number">123</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> newAaa(<span class="number">1</span>, <span class="string">&#x27;aa&#x27;</span>).name);</span><br><span class="line"><span class="built_in">console</span>.log(newAaa.prototype.name);</span><br><span class="line"><span class="comment">//获取该对象或者方法自身属性的描述</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getOwnPropertyDescriptors(newAaa));</span><br><span class="line"><span class="comment">// newAaa();</span></span><br><span class="line"><span class="comment">// new newAaa();</span></span><br><span class="line"><span class="comment">// let aa = new newAaa(&#x27;王五&#x27;);</span></span><br><span class="line"><span class="comment">// console.log(aa);</span></span><br><span class="line"><span class="comment">// aa.selfBind(obj2)();</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// let newAaa = aaa.bind(obj, &#x27;name&#x27;);</span></span><br><span class="line"><span class="comment">// newAaa(&#x27;111&#x27;).getName();</span></span><br><span class="line"><span class="comment">// console.log(aaa.__proto__ === newAaa.__proto__);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 1:改变this指向</span></span><br><span class="line"><span class="comment">* 2:是一个&#x27;函数&#x27;调用bind</span></span><br><span class="line"><span class="comment">* 3:返回一个新的函数 但不执行 只有调用的时候才执行</span></span><br><span class="line"><span class="comment">* 4:调用bind传入的参数  和真正调用函数的参数 有一个参数融合</span></span><br><span class="line"><span class="comment">* 5:new 调用和普通调用</span></span><br><span class="line"><span class="comment">* 6:原型属性是一样的</span></span><br><span class="line"><span class="comment">* 7:原型链属性一致</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>);</span><br></pre></td></tr></table></figure>
<h2 id="简单实现Promsie"><a href="#简单实现Promsie" class="headerlink" title="简单实现Promsie"></a>简单实现Promsie</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myPromsie</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">cetor</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// 三个状态 等待 失败 成功</span></span><br><span class="line">        <span class="comment">// 等待=》成功  等待=》失败 必须有一个结果</span></span><br><span class="line">        <span class="built_in">this</span>.state = <span class="string">&quot;pending&quot;</span> <span class="comment">//等待</span></span><br><span class="line">        <span class="built_in">this</span>.successFul = <span class="literal">undefined</span></span><br><span class="line">        <span class="built_in">this</span>.faild = <span class="literal">undefined</span></span><br><span class="line">        <span class="comment">// 定义执行的队列</span></span><br><span class="line">        <span class="built_in">this</span>.resolveRrr = [] <span class="comment">//成功的数组</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            cetor(<span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">this</span>.state == <span class="string">&quot;pending&quot;</span>) &#123;</span><br><span class="line">                    <span class="comment">// 修修改状态</span></span><br><span class="line">                    <span class="built_in">this</span>.state = <span class="string">&quot;successFul&quot;</span></span><br><span class="line">                    <span class="built_in">this</span>.successFul = args</span><br><span class="line">                    <span class="built_in">this</span>.resolveRrr.forEach(<span class="function">(<span class="params">fn</span>) =&gt;</span> &#123;</span><br><span class="line">                        fn.onResolve(<span class="built_in">this</span>.successFul)</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">this</span>.state == <span class="string">&quot;pending&quot;</span>) &#123;</span><br><span class="line">                    <span class="comment">// 修修改状态</span></span><br><span class="line">                    <span class="built_in">this</span>.state = <span class="string">&quot;faild&quot;</span></span><br><span class="line">                    <span class="built_in">this</span>.faild = args</span><br><span class="line">                    <span class="built_in">this</span>.resolveRrr.forEach(<span class="function">(<span class="params">fn</span>) =&gt;</span> &#123;</span><br><span class="line">                        fn.onReject(<span class="built_in">this</span>.faild)</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="title">then</span>(<span class="params">onResolve, onReject</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.state == <span class="string">&quot;pending&quot;</span>) &#123;</span><br><span class="line">            <span class="comment">// 对象形式传进去</span></span><br><span class="line">            <span class="built_in">this</span>.resolveRrr.push(&#123;</span><br><span class="line">                onResolve,</span><br><span class="line">                onReject</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.state == <span class="string">&quot;successFul&quot;</span>) &#123;</span><br><span class="line">            onResolve(<span class="built_in">this</span>.successFul)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.state == <span class="string">&quot;faild&quot;</span>) &#123;</span><br><span class="line">            onReject(<span class="built_in">this</span>.faild)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="keyword">let</span> aa = <span class="keyword">new</span> myPromsie(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// resolve(&#x27;田百万&#x27;)</span></span><br><span class="line">        reject(<span class="string">&quot;asd&quot;</span>)</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;)</span><br><span class="line">aa.then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(err);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="查找对应括号"><a href="#查找对应括号" class="headerlink" title="查找对应括号"></a>查找对应括号</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> fun = <span class="function"><span class="keyword">function</span> (<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> items = []</span><br><span class="line">    <span class="keyword">let</span> numLength = num.length</span><br><span class="line">    <span class="comment">// 先判断 有没有多余的括号</span></span><br><span class="line">    <span class="keyword">if</span> (numLength % <span class="number">2</span> != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 遍历整个字符串</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> a = <span class="number">0</span>; a &lt; numLength; a++) &#123;</span><br><span class="line">        <span class="keyword">let</span> newNum = items[items.length - <span class="number">1</span>]</span><br><span class="line">        <span class="comment">// 23 14 05 </span></span><br><span class="line">        <span class="keyword">switch</span> (num[a]) &#123;</span><br><span class="line">            <span class="comment">// 判断依次push</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;(&#x27;</span>:</span><br><span class="line">                items.push(<span class="string">&#x27;(&#x27;</span>) <span class="comment">//放到栈里边</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;[&#x27;</span>:</span><br><span class="line">                items.push(<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;&#123;&#x27;</span>:</span><br><span class="line">                items.push(<span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;)&quot;</span>:</span><br><span class="line">                <span class="keyword">if</span> (newNum == <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                    items.pop() <span class="comment">//一样的话就丢出来</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;]&quot;</span>:</span><br><span class="line">                <span class="keyword">if</span> (newNum == <span class="string">&#x27;[&#x27;</span>) &#123;</span><br><span class="line">                    items.pop()</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;&#125;&quot;</span>:</span><br><span class="line">                <span class="keyword">if</span> (newNum == <span class="string">&#x27;&#123;&#x27;</span>) &#123;</span><br><span class="line">                    items.pop()</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> items.length == <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> aa = <span class="string">&#x27;(]&#x27;</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&#x27;[&#123;()()&#123;&#125;&#125;]&#x27;</span></span><br><span class="line"><span class="keyword">let</span> bb = <span class="string">&#x27;[&#125;&#x27;</span></span><br><span class="line"><span class="keyword">let</span> cc = <span class="string">&#x27;()&#x27;</span></span><br><span class="line"><span class="built_in">console</span>.log(fun(str));</span><br><span class="line"><span class="built_in">console</span>.log(fun(bb));</span><br><span class="line"><span class="built_in">console</span>.log(fun(cc));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="手写深拷贝"><a href="#手写深拷贝" class="headerlink" title="手写深拷贝"></a>手写深拷贝</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;田林汇&quot;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="string">&quot;20&quot;</span>,</span><br><span class="line">      <span class="attr">colors</span>: [<span class="string">&quot;yellow&quot;</span>, <span class="string">&quot;blue&quot;</span>],</span><br><span class="line">      <span class="attr">friends</span>: &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&quot;刀哥&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">cloneDeep</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">&quot;object&quot;</span> || obj == <span class="literal">null</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> obj</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">let</span> result;</span><br><span class="line">      <span class="keyword">if</span>(obj <span class="keyword">instanceof</span> <span class="built_in">Array</span>)&#123; <span class="comment">//如果传入的是个数组</span></span><br><span class="line">          result=[]<span class="comment">//默认给个数组</span></span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          result=&#123;&#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">          <span class="comment">// 只访问对象自身的属性</span></span><br><span class="line">          <span class="keyword">if</span> (obj.hasOwnProperty( key)) &#123;</span><br><span class="line">             result[key]=cloneDeep(obj[key])</span><br><span class="line">              </span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> result</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> obj1 = cloneDeep(obj)</span><br><span class="line">  obj1.name=<span class="string">&quot;huihui&quot;</span></span><br><span class="line">  obj1.friends.name=<span class="string">&quot;huihui&quot;</span></span><br><span class="line">  <span class="built_in">console</span>.log(obj1);</span><br></pre></td></tr></table></figure>

<h2 id="请求失败重连"><a href="#请求失败重连" class="headerlink" title="请求失败重连"></a>请求失败重连</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">requestAgain</span>(<span class="params">request,port,time,params</span>)</span>&#123; <span class="comment">//传递的参数 时间和次数</span></span><br><span class="line">    <span class="comment">// await后边跟着的是一个Promise</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">// 在这里边要执行的操作就是 不但的执行request请求 直到成功或者达到上限为止</span></span><br><span class="line">        <span class="comment">// 写一个函数 这里边是要执行的操作</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">excutePromise</span>(<span class="params">timer</span>)</span>&#123;</span><br><span class="line">            <span class="comment">// 1.判断次数</span></span><br><span class="line">            <span class="keyword">if</span>(port&lt;<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="comment">// 1.1清除定时器</span></span><br><span class="line">                <span class="built_in">clearInterval</span>(timer)</span><br><span class="line">                <span class="comment">// 1.2调用reject 抛出一个错误</span></span><br><span class="line">                reject(<span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&quot;promise not until timeout&quot;</span>))</span><br><span class="line">                <span class="comment">// 1.3 return 一个undefined</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">void</span> <span class="number">0</span>; <span class="comment">//void 0 就是undefined</span></span><br><span class="line">            &#125;</span><br><span class="line">            port-=<span class="number">1</span> <span class="comment">//每执行一次的时候让次数减一</span></span><br><span class="line">            <span class="comment">// 2 等待成功</span></span><br><span class="line">            <span class="keyword">let</span>  &#123;url,args&#125;=params <span class="comment">//这是传的参数</span></span><br><span class="line">            <span class="keyword">return</span> request(url,args).then(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">                <span class="built_in">clearInterval</span>(timer) <span class="comment">//成功以后清除定时器</span></span><br><span class="line">                resolve(res)</span><br><span class="line">            &#125;).catch(<span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(e) <span class="comment">//有错误就抛出错误</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 定时器 隔一段时间就会执行</span></span><br><span class="line">        <span class="keyword">let</span> timer=<span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            excutePromise(timer) </span><br><span class="line">        &#125;, time);</span><br><span class="line">        <span class="comment">// 一进来就执行一次</span></span><br><span class="line">            excutePromise(timer)</span><br><span class="line">    &#125;)</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="封装co模块"><a href="#封装co模块" class="headerlink" title="封装co模块"></a>封装co模块</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 封装一个co模块</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">generator</span>) </span>&#123;</span><br><span class="line">     <span class="keyword">let</span> gen = generator() <span class="comment">//执行了这个generator函数</span></span><br><span class="line">     <span class="comment">// console.log(gen);</span></span><br><span class="line">     <span class="comment">//结合next 结合done</span></span><br><span class="line">     <span class="comment">// 主要思想是递归</span></span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params">data</span>) </span>&#123; <span class="comment">//接受的参数</span></span><br><span class="line">         <span class="keyword">let</span> result = gen.next(data) <span class="comment">//从实例中取出来 value 和done &#123;value，done&#125;</span></span><br><span class="line">         <span class="keyword">if</span> (result.done) <span class="keyword">return</span> result.value <span class="comment">//true 的话就是执行完了</span></span><br><span class="line">         <span class="comment">// 必须在第一次的继承上 才能调用此三次的递归</span></span><br><span class="line">         <span class="keyword">if</span> (result.value <span class="keyword">instanceof</span> <span class="built_in">Promise</span>) &#123; <span class="comment">//证明这个值是promise的实例才会走  看50行yiled后边跟的</span></span><br><span class="line">             result.value.then(<span class="function">(<span class="params">newData</span>) =&gt;</span> &#123;</span><br><span class="line">                 next(newData) <span class="comment">//递归</span></span><br><span class="line">             &#125;)</span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">             <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">&quot;after yiled params must be a instanceof Promise&quot;</span>)</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     next()</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">getAsyncResult</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">         <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">             resolve(<span class="string">&quot;111&quot;</span>)</span><br><span class="line">         &#125;, <span class="number">0</span>)</span><br><span class="line">     &#125;)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">getAsyncResult1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">         <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">             resolve(<span class="string">&quot;222&quot;</span>)</span><br><span class="line">         &#125;, <span class="number">0</span>)</span><br><span class="line">     &#125;)</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">function</span>* <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     <span class="keyword">let</span> res = <span class="keyword">yield</span> getAsyncResult()</span><br><span class="line">     <span class="keyword">let</span> res1 = <span class="keyword">yield</span> getAsyncResult1()</span><br><span class="line">   <span class="comment">//   console.log(res);</span></span><br><span class="line">   <span class="comment">//   console.log(res1);</span></span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"> run(fn)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="promise封装AJAX请求"><a href="#promise封装AJAX请求" class="headerlink" title="promise封装AJAX请求"></a>promise封装AJAX请求</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> $<span class="title">request</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="title">ajax</span>(<span class="params">url, method, data, type</span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 创建兼容xmlrequest对象</span></span><br><span class="line">                <span class="keyword">const</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">                <span class="comment">// 添加请求事件并且监听</span></span><br><span class="line">                xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">var</span> res</span><br><span class="line">                    <span class="comment">// 判断状态码</span></span><br><span class="line">                    <span class="keyword">if</span> (xhr.status === <span class="number">200</span> &amp;&amp; xhr.readyState == <span class="number">4</span>) &#123; <span class="comment">//成功</span></span><br><span class="line">                        <span class="comment">// 根据类型判断 做怎样的处理</span></span><br><span class="line">                        <span class="keyword">if</span> (type == <span class="string">&quot;json&quot;</span>) &#123;</span><br><span class="line">                            res = <span class="built_in">JSON</span>.parse(xhr.responseText)</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="string">&quot;xml&quot;</span>) &#123;</span><br><span class="line">                            res = responseXML</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            res = xhr.responseText</span><br><span class="line">                        &#125;</span><br><span class="line">                        resolve(res)</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                xhr.onerrer = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    reject(xhr.statusText)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">let</span> param = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="comment">// 判断data是否有数据</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">JSON</span>.stringify(data) !== <span class="string">&#x27;&#123;&#125;&#x27;</span>) &#123;</span><br><span class="line">                    url += <span class="string">&#x27;?&#x27;</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> data) &#123;</span><br><span class="line">                        param += i + <span class="string">&#x27;=&#x27;</span> + data[i] + <span class="string">&#x27;&amp;&#x27;</span> <span class="comment">// 将js对象重组，拼接成url参数存入param变量中</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 使用slice函数提取一部分字符串，这里主要是为了去除拼接的最后一个&amp;字符</span></span><br><span class="line">                    param = param.slice(<span class="number">0</span>, param.length - <span class="number">1</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 判断请求方式</span></span><br><span class="line">                <span class="keyword">if</span> (method === <span class="string">&#x27;get&#x27;</span>) &#123;</span><br><span class="line">                    <span class="comment">// 是则将数据拼接在url后面</span></span><br><span class="line">                    url = url + param</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 初始化请求</span></span><br><span class="line">                xhr.open(method, url, <span class="literal">true</span>)</span><br><span class="line">                <span class="keyword">if</span> (method == <span class="string">&quot;post&quot;</span>) &#123;</span><br><span class="line">                    <span class="comment">// xhr.setRequestHeader(&#x27;Content-Type&#x27;, &#x27;application/json&#x27;) // 设置请求头</span></span><br><span class="line">                    xhr.send(<span class="built_in">JSON</span>.stringify(data)) <span class="comment">//发送请求</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    xhr.send(<span class="literal">null</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> $ = <span class="keyword">new</span> $request()</span><br><span class="line">    <span class="keyword">let</span> newData = &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;辉辉&quot;</span>,</span><br><span class="line">        <span class="attr">age</span>: <span class="string">&quot;12&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// console.log($.ajax);</span></span><br><span class="line">    <span class="built_in">document</span>.querySelector(<span class="string">&#x27;.btn1&#x27;</span>).onclick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        $.ajax(<span class="string">&quot;http://localhost:3000/list&quot;</span>, <span class="string">&#x27;get&#x27;</span>, newData, <span class="string">&#x27;json&#x27;</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(res);</span><br><span class="line">        &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2 id="原生继承"><a href="#原生继承" class="headerlink" title="原生继承"></a>原生继承</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//缺点：</span></span><br><span class="line"><span class="comment">//父类的构造没有执行 不能传参</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    Parent.prototype.sayHui = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;我是千树辉&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">    Child.prototype.sayYang = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;我是阳阳&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Child.prototype.__proto__ = Parent.prototype</span></span><br><span class="line">    Child.prototype.__proto__ = <span class="keyword">new</span> Parent()</span><br><span class="line">    <span class="keyword">let</span> Son = <span class="keyword">new</span> Child()</span><br><span class="line">    Son.sayHui()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="组合继承"><a href="#组合继承" class="headerlink" title="组合继承"></a>组合继承</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//优点：可以继承父类的原型内容 也不会造成原型里边的属性修改</span></span><br><span class="line"><span class="comment">//缺点：</span></span><br><span class="line"><span class="comment">//让parent的构造执行了两次 出现了undefined</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.Parentname=name</span><br><span class="line">    &#125;</span><br><span class="line">    Parent.prototype.sayHui = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;我是千树辉&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">        Parent.call(<span class="built_in">this</span>,name)</span><br><span class="line">        <span class="built_in">this</span>.Childname=name</span><br><span class="line">    &#125;</span><br><span class="line">      Child.prototype.sayYang = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;我是阳阳&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Child.prototype.__proto__ = <span class="keyword">new</span> Parent()</span><br><span class="line">    <span class="keyword">let</span> Son = <span class="keyword">new</span> Child(<span class="string">&quot;hui&quot;</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(Son.Parentname);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="组合寄生继承"><a href="#组合寄生继承" class="headerlink" title="组合寄生继承"></a>组合寄生继承</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.Parentname = name</span><br><span class="line">&#125;</span><br><span class="line">Parent.prototype.sayHui = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;我是千树辉&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    Parent.call(<span class="built_in">this</span>, name)</span><br><span class="line">    <span class="built_in">this</span>.Childname = name</span><br><span class="line">&#125;</span><br><span class="line">Child.prototype.sayYang = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;我是阳阳&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> Child.prototype.__proto__ = <span class="built_in">Object</span>.create(Parent.prototype)<span class="comment">//浅拷贝创建一个对象</span></span><br><span class="line"><span class="keyword">let</span> Son = <span class="keyword">new</span> Child(<span class="string">&quot;hui&quot;</span>)</span><br><span class="line"><span class="built_in">console</span>.log(Son.Parentname);</span><br></pre></td></tr></table></figure>
        </div>

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2021/04/24/Interview/vueReact/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">vue和react区别</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2020/08/03/vue/router/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">router</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2018</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">TianLeon</a>
        </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.3</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0%E5%B8%B8%E8%A7%81%E7%9A%84JS%E6%BA%90%E7%A0%81"><span class="nav-number">1.</span> <span class="nav-text">手动实现常见的JS源码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ES5%E5%AE%9E%E7%8E%B0call"><span class="nav-number">1.1.</span> <span class="nav-text">ES5实现call</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ES5%E5%AE%9E%E7%8E%B0bind"><span class="nav-number">1.2.</span> <span class="nav-text">ES5实现bind</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0Promsie"><span class="nav-number">1.3.</span> <span class="nav-text">简单实现Promsie</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E5%AF%B9%E5%BA%94%E6%8B%AC%E5%8F%B7"><span class="nav-number">1.4.</span> <span class="nav-text">查找对应括号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%8B%E5%86%99%E6%B7%B1%E6%8B%B7%E8%B4%9D"><span class="nav-number">1.5.</span> <span class="nav-text">手写深拷贝</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%B1%E8%B4%A5%E9%87%8D%E8%BF%9E"><span class="nav-number">1.6.</span> <span class="nav-text">请求失败重连</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%81%E8%A3%85co%E6%A8%A1%E5%9D%97"><span class="nav-number">1.7.</span> <span class="nav-text">封装co模块</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#promise%E5%B0%81%E8%A3%85AJAX%E8%AF%B7%E6%B1%82"><span class="nav-number">1.8.</span> <span class="nav-text">promise封装AJAX请求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E7%94%9F%E7%BB%A7%E6%89%BF"><span class="nav-number">1.9.</span> <span class="nav-text">原生继承</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E7%BB%A7%E6%89%BF"><span class="nav-number">1.10.</span> <span class="nav-text">组合继承</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E5%AF%84%E7%94%9F%E7%BB%A7%E6%89%BF"><span class="nav-number">1.11.</span> <span class="nav-text">组合寄生继承</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>






    
<script src="/js/lazyload.js"></script>



<div class="post-scripts">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>



</body>
</html>
